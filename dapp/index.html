<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WTBTC - Wrapped Testnet Bitcoin DApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .main-panel {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-group {
            margin-bottom: 20px;
        }

        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            margin-top: 8px;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        label {
            display: block;
            color: #555;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .tx-hash {
            font-family: monospace;
            font-size: 0.9em;
            color: #666;
            word-break: break-all;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-confirmed {
            background: #d4edda;
            color: #155724;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸª™ WTBTC</h1>
            <p class="subtitle">Wrapped Testnet Bitcoin DApp</p>
            <p class="subtitle">Bridge Bitcoin â†” Ethereum</p>
        </header>

        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Supply</div>
                <div class="stat-value" id="totalSupply">100M</div>
                <div class="stat-label">WTBTC</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Your Balance</div>
                <div class="stat-value" id="userBalance">0</div>
                <div class="stat-label">WTBTC</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Network</div>
                <div class="stat-value" style="font-size: 1.5em;" id="network">Ethereum</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Contract</div>
                <div class="stat-value" style="font-size: 0.8em;" id="contractAddr">Not Connected</div>
            </div>
        </div>

        <!-- Main Panel -->
        <div class="main-panel">
            <h2 class="section-title">ðŸ”— Connect Wallet</h2>
            <div id="walletStatus" class="alert alert-info">
                Please connect your wallet to interact with WTBTC
            </div>
            <div class="button-group">
                <button onclick="connectWallet()">Connect MetaMask</button>
                <button onclick="connectWalletConnect()">WalletConnect</button>
                <button onclick="connectCoinbase()">Coinbase Wallet</button>
            </div>
        </div>

        <!-- Bridge Section -->
        <div class="main-panel">
            <h2 class="section-title">ðŸŒ‰ Bridge to Bitcoin</h2>
            <div class="input-group">
                <label for="burnAmount">Amount to Burn (WTBTC)</label>
                <input type="number" id="burnAmount" placeholder="0.0" step="0.00000001">
            </div>
            <div class="input-group">
                <label for="btcAddress">Bitcoin Destination Address</label>
                <input type="text" id="btcAddress" placeholder="bc1q..." value="bc1qfzhx87ckhn4tnkswhsth56h0gm5we4hdq5wass">
            </div>
            <button onclick="burnAndBridge()" style="width: 100%;">ðŸ”¥ Burn WTBTC â†’ Receive BTC</button>
            <div id="burnStatus"></div>
        </div>

        <!-- Transfer Section -->
        <div class="main-panel">
            <h2 class="section-title">ðŸ’¸ Transfer WTBTC</h2>
            <div class="input-group">
                <label for="transferTo">Recipient Address</label>
                <input type="text" id="transferTo" placeholder="0x...">
            </div>
            <div class="input-group">
                <label for="transferAmount">Amount (WTBTC)</label>
                <input type="number" id="transferAmount" placeholder="0.0" step="0.00000001">
            </div>
            <button onclick="transferTokens()" style="width: 100%;">Send WTBTC</button>
            <div id="transferStatus"></div>
        </div>

        <!-- Pending Burns Section -->
        <div class="main-panel">
            <h2 class="section-title">ðŸ“‹ Pending Burns</h2>
            <div class="transaction-list" id="pendingBurns">
                <p style="text-align: center; color: #666;">No pending burns</p>
            </div>
            <button onclick="refreshPendingBurns()">Refresh</button>
        </div>

        <!-- Transaction History -->
        <div class="main-panel">
            <h2 class="section-title">ðŸ“œ Recent Transactions</h2>
            <div class="transaction-list" id="txHistory">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // DApp State
        let web3Provider = null;
        let userAccount = null;
        let wtbtcContract = null;

        // Mock contract address (replace with actual deployed address)
        const WTBTC_ADDRESS = "0x" + "..." + "DEPLOYED_CONTRACT_ADDRESS";

        // Connect Wallet Functions
        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    userAccount = accounts[0];
                    updateWalletStatus('Connected: ' + userAccount.substring(0, 6) + '...' + userAccount.substring(38), 'success');
                    loadBalance();
                    loadContractInfo();
                } catch (error) {
                    updateWalletStatus('Failed to connect: ' + error.message, 'error');
                }
            } else {
                updateWalletStatus('MetaMask not detected. Please install MetaMask.', 'error');
            }
        }

        function connectWalletConnect() {
            updateWalletStatus('WalletConnect integration coming soon!', 'info');
        }

        function connectCoinbase() {
            updateWalletStatus('Coinbase Wallet integration coming soon!', 'info');
        }

        function updateWalletStatus(message, type) {
            const statusDiv = document.getElementById('walletStatus');
            statusDiv.className = `alert alert-${type}`;
            statusDiv.innerHTML = message;
        }

        // Load contract info
        function loadContractInfo() {
            document.getElementById('contractAddr').textContent = WTBTC_ADDRESS.substring(0, 10) + '...';
            document.getElementById('network').textContent = 'Mainnet';
        }

        // Load user balance (mock)
        function loadBalance() {
            // In real implementation, call contract's balanceOf
            document.getElementById('userBalance').textContent = '5,000.00';
        }

        // Burn and Bridge function
        async function burnAndBridge() {
            const amount = document.getElementById('burnAmount').value;
            const btcAddress = document.getElementById('btcAddress').value;

            if (!amount || !btcAddress) {
                showBurnStatus('Please enter amount and Bitcoin address', 'error');
                return;
            }

            if (!btcAddress.startsWith('bc1') && !btcAddress.startsWith('tb1')) {
                showBurnStatus('Invalid Bitcoin address format', 'error');
                return;
            }

            showBurnStatus('Burning ' + amount + ' WTBTC and bridging to ' + btcAddress + '...', 'info');

            // Simulate transaction
            setTimeout(() => {
                const txHash = '0x' + Math.random().toString(16).substring(2, 66);
                showBurnStatus(
                    `âœ… Burn successful!<br>
                    TX: <span class="tx-hash">${txHash}</span><br>
                    <strong>Bitcoin will be sent to: ${btcAddress}</strong><br>
                    Monitor the pending burns section for status.`,
                    'success'
                );
                addTransaction('Burn & Bridge', amount + ' WTBTC', txHash, 'confirmed');
                refreshPendingBurns();
            }, 2000);
        }

        function showBurnStatus(message, type) {
            const statusDiv = document.getElementById('burnStatus');
            statusDiv.className = `alert alert-${type}`;
            statusDiv.innerHTML = message;
            statusDiv.style.marginTop = '15px';
        }

        // Transfer tokens
        async function transferTokens() {
            const to = document.getElementById('transferTo').value;
            const amount = document.getElementById('transferAmount').value;

            if (!to || !amount) {
                showTransferStatus('Please enter recipient and amount', 'error');
                return;
            }

            showTransferStatus('Transferring ' + amount + ' WTBTC to ' + to + '...', 'info');

            setTimeout(() => {
                const txHash = '0x' + Math.random().toString(16).substring(2, 66);
                showTransferStatus(
                    `âœ… Transfer successful!<br>TX: <span class="tx-hash">${txHash}</span>`,
                    'success'
                );
                addTransaction('Transfer', amount + ' WTBTC to ' + to.substring(0, 10) + '...', txHash, 'confirmed');
            }, 2000);
        }

        function showTransferStatus(message, type) {
            const statusDiv = document.getElementById('transferStatus');
            statusDiv.className = `alert alert-${type}`;
            statusDiv.innerHTML = message;
            statusDiv.style.marginTop = '15px';
        }

        // Refresh pending burns
        function refreshPendingBurns() {
            const pendingDiv = document.getElementById('pendingBurns');
            // Mock pending burns
            pendingDiv.innerHTML = `
                <div class="transaction-item">
                    <div><strong>Burn ID:</strong> <span class="tx-hash">0xabc123...def456</span></div>
                    <div><strong>Amount:</strong> 5000.0 WTBTC</div>
                    <div><strong>Destination:</strong> bc1qfzhx87ckhn4tnkswhsth56h0gm5we4hdq5wass</div>
                    <div><strong>Status:</strong> <span class="status-badge status-pending">Processing</span></div>
                    <div style="margin-top: 10px;"><strong>Bitcoin TX:</strong> Pending...</div>
                </div>
            `;
        }

        // Add transaction to history
        function addTransaction(type, details, txHash, status) {
            const historyDiv = document.getElementById('txHistory');
            const txItem = document.createElement('div');
            txItem.className = 'transaction-item';
            txItem.innerHTML = `
                <div><strong>${type}</strong></div>
                <div>${details}</div>
                <div class="tx-hash">${txHash}</div>
                <div><span class="status-badge status-${status}">${status === 'confirmed' ? 'Confirmed' : 'Pending'}</span></div>
            `;
            historyDiv.insertBefore(txItem, historyDiv.firstChild);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('WTBTC DApp loaded');
            // Add some mock transactions
            addTransaction('Mint', '100 WTBTC', '0x123...abc', 'confirmed');
            refreshPendingBurns();
        });
    </script>
</body>
</html>
